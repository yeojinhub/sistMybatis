<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.sist.day0610">

<!--
union
본사(emp)와 지사(cp_emp7) 사원을 모두 검색
사원번호, 사원명, 직무, 연봉, 보너스, 입사일
-->
<!-- 중복쿼리문을 정의 -->
<sql id="empDup">
select empno, ename, job, sal, comm, hiredate
</sql>

<!-- 중복 쿼리문을 정의 -->
<resultMap type="cpEmpDomain" id="ceResult">
<result column="EMPNO" property="empno" />
<result column="ENAME" property="ename" />
<result column="JOB" property="job" />
<result column="SAL" property="sal" />
<result column="COMM" property="comm" />
<result column="HIREDATE" property="hiredate" />
</resultMap>

<!-- 중복 쿼리문을 사용하는 노드를 작성 -->
<select id="union" resultMap="ceResult">
<include refid="empDup" />
from emp
union all
<include refid="empDup" />
from cp_emp7
</select>

<!--
join
모델을 입력받아 보유중인 모델의 제조사, 모델명, 년식, 가격, 배기량, 이미지, 입력일을 조회
car_maker, car_model
-->
<resultMap type="carDomain" id="carResult">
<result column="maker" property="maker" />
<result column="model" property="model" />
<result column="car_year" property="car_year" />
<result column="price" property="price" />
<result column="cc" property="cc" />
<result column="car_img" property="car_img" />
<result column="hiredate" property="hiredate" />
</resultMap>

<select id="selectAllModel" resultType="String">
select model
from car_maker
</select>

<select id="join"  resultMap="carResult" parameterType="String">
select 	cmak.maker, cmak.model,
				cmod.car_year, cmod.price, cmod.cc, cmod.car_img, cmod.hiredate
from 		car_maker cmak, car_model cmod
where 	(cmod.model = cmak.model)
			 	and cmak.model=#{ model }
</select>

<!-- subquery join -->

<!-- dynamic query OGNL -->

<!-- $사용 -->


</mapper>
    